.verify-job:
  stage: verify
  extends: .rules:code-changes
  # image: ${VERIFY_IMAGE}
  image: registry.gitlab.com/gitlab-org/gitlab-build-images:ruby-2.7.2.patched-golang-1.16-git-2.31-lfs-2.9-chrome-89-node-14.15-yarn-1.22-postgresql-12-graphicsmagick-1.3.36
  needs:
    - release-image
  artifacts:
    paths:
      - ./gitlab-development-kit/gitlab/log/*.log
      - ./gitlab-development-kit/log
    expire_in: 2 days
    when: always
  retry: 1
  # variables:
  #   BUNDLE_PATH: '$CI_PROJECT_DIR/.bundle'
  # cache:
  #   key:
  #     prefix: "gdk-verify"
  #     files:
  #       - .tool-versions
  #   paths:
  #     - .bundle

install:
  extends: .verify-job
  script:
    - support/ci/verify-install

# update-from-default-branch:
#   extends: .verify-job
#   script:
#     - support/ci/verify-update $CI_DEFAULT_BRANCH

# update-from-mr-branch:
#   extends: .verify-job
#   script:
#     - support/ci/verify-update
